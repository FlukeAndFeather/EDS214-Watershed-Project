---
title: "Chemistry of watersheds from the Luquillo Mountains, Puerto Rico"
format: html
editor: visual
warning: FALSE
---


```{r}
library(tidyverse)
library(janitor)
source(here::here("R", "revised-func-watershed.R"))
```

## Background

This repository presents visual representation of a) potassium, (b) nitrate-N, (c) magnesium, (d) calcium and (e) ammonium-N  ions before and after hurricane Hugo in Puerto Rico. Four watersheds namely Quebrada uno-Bisley (Q1), Quebrada dos-Bisley (Q2), Quebrada tres-Bisley (Q3) and Puente Roto Mameyes (PRM) at the Luquillo Mountain of Puerto Rico were taken as  a sample sites to calculate time-series plots of 9 weeks moving average from year 1988 to 1994.

## Workflow

![workflow](Workflow.png)

## Data Source
The data was extracted from McDowell and International Institute Of Tropical Forestry (IITF). [link](https://portal.edirepository.org/nis/mapbrowse?packageid=knb-lter-luq.20.4923064)

## Data

```{r}
readRDS(watersheds_combined, "outputs/watersheds_combined.rds")
readRDS(watersheds, "outputs/watersheds.rds")
readRDS(watersheds_ma, "outputs/watersheds_ma.rds")
```

## Data visualization

```{r}
# Create a ggplot!

ggplot(data = watersheds_ma, aes(x = sample_date, y = moving_avg_value, linetype = sites)) +
  geom_line(na.rm = TRUE) +
  facet_wrap(~ion,
             scales = "free_y",
             ncol = 1) +
  geom_vline(xintercept = as.Date("1989-09-18"),
             colour="black",
             linetype = "dotdash") +
  labs(title = "Average concentration of ions before and after hurricane Hugo",
       x = "Year",
       y = "Nine weeks moving average of the ion") +
  theme_minimal() +
  scale_linetype_manual(values = c("solid", "dotted", "dashed", "dotdash"))
```

```{r}
# Save ggplot

ggsave(here::here("figs", "avg_conc.jpg"))
```
